<!DOCTYPE html>
<html lang="en">
	<!-- Version 0.5-->
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="./css/style.css">
	<script src="js/script.js"></script>
	<script>
		async function refresh(){
			let schedules = await getSchedules();
			if(schedules == "Aucun passage de prévu"){
				HTMLContent = '<div class="colfix dest-ligne"><div class="ligne-img">-</div><div class="dest-txt">Aucun passage de prévu</div><div class="time-txt">-</div></div>';
				document.getElementById('passages').innerHTML = HTMLContent;
			}else{
				let finalSchedules = sort(schedules);
			
				HTMLContent = "";
				
				if(finalSchedules.length >= 4){
					for (let i = 0; i <= 3; i++) {
						if(finalSchedules[i].time >= 0){
					HTMLContent += '<div class="colfix dest-ligne"><div class="ligne-img"><img src="img/';
					HTMLContent += finalSchedules[i].line;
					HTMLContent += '_600px.png" alt="16"/></div><div class="dest-txt">';
					HTMLContent += finalSchedules[i].lastStop + '</div><div class="time-txt">';
					if(finalSchedules[i].time == 0){
						HTMLContent += "<1";
					}else{
						HTMLContent += finalSchedules[i].time;
					}
					HTMLContent += "min";
					if(finalSchedules[i].realtime != true){
						HTMLContent += "*";
					}
					HTMLContent += "</div>";
					HTMLContent += "</div>";
					HTMLContent += '<div class="lignegrise"></div>';
				}
					}
				}else{
					finalSchedules.forEach(element => {
					if(element.time >= 0){
					HTMLContent += '<div class="colfix dest-ligne"><div class="ligne-img"><img src="img/'
					HTMLContent += element.line;
					HTMLContent += '_600px.png" alt="16"/></div><div class="dest-txt">';
					HTMLContent += element.lastStop + '</div><div class="time-txt">';
					if(element.time == 0){
						HTMLContent += "<1";
					}else{
						HTMLContent += element.time;
					}
					HTMLContent += "min";
					if(element.realtime != true){
						HTMLContent += "*";
					}
					HTMLContent += "</div>";
					HTMLContent += "</div>";
					HTMLContent += '<div class="lignegrise"></div>';
				}

				});
				}

				

				document.getElementById('passages').innerHTML = HTMLContent;

			}
		};
		setInterval(function(){ 
			refresh();   
		}, 5000);
		setInterval(function(){ 
			let time = getTime();  
			document.getElementById('time').innerHTML = time;
			
		}, 1000);
	</script>
	<script>
		
	</script>
	<title>Corenc - Montfleury</title>
</head>
<body onload="document.getElementById('time').innerHTML = getTime(); refresh();">
	
	<div id="cadre"><!-- Cadre Noir-->
		<div class="main-grid">
			<div class="main">Prochains départs Monfleury</div>
			<div class="txth"><span id="time">10:07</span></div>
		</div>
		<div class="ligneblanche"></div>
		<div class="txtfix colfix"><!-- Ligne texte-->
			<div class="">Ligne</div>
			<div class="">Destination</div>
			<div class="">Temps d'attente</div>
		</div>
		<div id="surcadre"> <!--Cadre blanc -->
			<div id="passages">
				<div class="colfix dest-ligne">
					<div class="ligne-img">
						
					</div>
					<div class="dest-txt">
						Chargement
					</div>
					<div class="time-txt">
						
					</div>
				</div>
				<div class="lignegrise"></div>
			</div>
			<div class="colfix dest-ligne">
				<div class="ligne-img"><img src="https://upload.wikimedia.org/wikipedia/fr/thumb/a/a0/TAG_%28Logotype_2014%29.svg/512px-TAG_%28Logotype_2014%29.svg.png" alt="TAG"></div>
				<div class="dest-txt">Je monte, Je valide !</div>
				<div class="time-txt"><img src="img/Cita_60px.png" alt="Citadis" /><span>
					V0.5				
				</span></div>
			</div>
		</div>
		<div class="colfix">
			<div></div>
			<div class="infoth txtfix">* : information théorique</div>
			<div class="txtfix "><span>
				
			</span></div>
		</div>
	</div>
</body>
</html>
